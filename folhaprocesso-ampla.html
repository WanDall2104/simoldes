<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Folha de Processos - Simoldes Aços Brasil</title>
    <link rel="shortcut icon" type="imagex/png" href="images/logo-navegador.jpeg">
    <link rel="stylesheet" href="css/style-folhaprocesso-ampla.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-left">
                <div class="process-label">FOLHA DE<br>PROCESSOS</div>
                <div class="logo">
                    <img src="images/logo-navegador-semfundo.png" alt="Simoldes">
                </div>
            </div>
            <div class="header-center">
                <div class="material-info">
                    <span class="info-label">Material:</span>
                    <span class="info-value">1730</span>
                </div>
            </div>
            <div class="header-right">
                <div class="date-info">
                    <span class="info-label">Impressão:</span>
                    <span class="info-value">Data: 10/02/2025 - 04:01</span>
                </div>
                <div class="piece-image">
                    <img src="images/image-molde01.png" alt="Visualização da peça">
                </div>
            </div>
        </div>

        <div class="project-info">
            <div class="info-row">
                <span class="info-label">Pasta dos Programas:</span>
                <span class="info-value">U:/F1400/1668_18</span>
            </div>
            <div class="info-row">
                <span class="info-label">Pasta do Projeto PowerMill:</span>
                <span class="info-value">L:/Cam Test/MOVIMENTOS POSTIÇO/MOLDE 1668/1668_18</span>
            </div>
            <div class="info-row">
                <span class="info-label">Programador:</span>
                <span class="info-value">diego.verciano</span>
            </div>
            <div class="info-row">
                <span class="info-label">Tempo Projeto:</span>
                <span class="info-value">04:57:26 </span>
                <span class="info-label">Sob Liq:</span>
                <span class="info-value">Sim</span>
            </div>
        </div>

        <div class="process-table">
            <table>
                <thead>
                    <tr>
                        <th>Programa</th>
                        <th>Percurso</th>
                        <th>Ref.</th>
                        <th>Comentário</th>
                        <th>Ø</th>
                        <th>RC</th>
                        <th>Rib.</th>
                        <th>Alt.</th>
                        <th>Z min</th>
                        <th>Lat.2D</th>
                        <th>Lat. Vert.</th>
                        <th>Lat.</th>
                        <th>Vert.</th>
                        <th>Tol.</th>
                        <th>Rot.</th>
                        <th>Av. Angular</th>
                        <th>Tempo Trab.</th>
                        <th>Corte</th>
                        <th>Total</th>
                        <th>Posição</th>
                        <th>Rúbrica</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>07</td>
                        <td>Furação</td>
                        <td class="center-text">Centro</td>
                        <td></td>
                        <td class="red-text">48</td>
                        <td class="red-text">0</td>
                        <td>247</td>
                        <td>273</td>
                        <td>-122</td>
                        <td>0</td>
                        <td>0</td>
                        <td>3</td>
                        <td></td>
                        <td>0.02</td>
                        <td>796</td>
                        <td>48</td>
                        <td>03:31:12</td>
                        <td>05:38:53</td>
                        <td></td>
                        <td>1° ABERTO/ABERTO</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td colspan="21" class="tool-row">
                            <div class="tool-info">
                                <span>Fresa:</span>
                                <span class="green-text">BR_TOPDRILL_048_SXD_70180011</span>
                                <span>Sup.:</span>
                                <span>78020010_SK50_CRI_C440-50_L187</span>
                            </div>
                        </td>
                    </tr>
                    <!-- Adicione mais linhas conforme necessário -->
                    <tr>
                        <td>08</td>
                        <td>Furação</td>
                        <td class="center-text">Centro</td>
                        <td></td>
                        <td class="red-text">42</td>
                        <td class="red-text">0</td>
                        <td>214</td>
                        <td>235</td>
                        <td>-171.9</td>
                        <td>0</td>
                        <td>0</td>
                        <td>3</td>
                        <td></td>
                        <td>0.03</td>
                        <td>909</td>
                        <td>55</td>
                        <td>00:11:20</td>
                        <td>00:11:48</td>
                        <td></td>
                        <td>1° ABERTO/ABERTO</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td colspan="21" class="tool-row">
                            <div class="tool-info">
                                <span>Fresa:</span>
                                <span class="green-text">BR_TOPDRILL_042_SXD_70180010</span>
                                <span>Sup.:</span>
                                <span>78020010_SK50_CRI_C440-50_L187</span>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="footer">
            <button class="nav-button" id="voltarBtn">
                <img src="/images/icon-back-white.png" alt="Voltar"> VOLTAR
            </button>
        </div>
    </div>
    
    <script src="scripts/folhaprocessos-ampla.js"></script>
    <script>
    (function() {
        function getQueryParam(...names) {
            const urlParams = new URLSearchParams(window.location.search);
            for (const name of names) {
                const val = urlParams.get(name);
                if (val) return val;
            }
            return null;
        }
        function showStyledAlert(msg) {
            const old = document.getElementById('customFolhaAlert');
            if (old) old.remove();
            const div = document.createElement('div');
            div.id = 'customFolhaAlert';
            div.style.position = 'fixed';
            div.style.top = '0';
            div.style.left = '0';
            div.style.width = '100vw';
            div.style.height = '100vh';
            div.style.background = 'rgba(0,0,0,0.25)';
            div.style.display = 'flex';
            div.style.alignItems = 'center';
            div.style.justifyContent = 'center';
            div.style.zIndex = '9999';
            div.innerHTML = `<div style="background:#fff;padding:32px 28px 24px 28px;border-radius:10px;box-shadow:0 8px 32px rgba(0,0,0,0.18);max-width:350px;text-align:center;"><div style='font-size:18px;font-weight:600;margin-bottom:16px;'>Atenção</div><div style='font-size:15px;margin-bottom:24px;'>${msg}</div><button style='background:#0f5132;color:#fff;padding:8px 22px;border:none;border-radius:5px;font-weight:600;cursor:pointer;' onclick='document.getElementById("customFolhaAlert").remove()'>OK</button></div>`;
            document.body.appendChild(div);
        }
        function preencherFolhaComProjeto(projeto) {
            if (!projeto || !projeto.folhaProcesso) return;
            const folha = projeto.folhaProcesso;
            // Material
            const materialEl = document.querySelector('.material-info .info-value, .material-info .span-info-material');
            if (materialEl) materialEl.textContent = folha.material || '';
            // Pasta dos Programas
            const pastaProgEl = document.querySelector('.project-info .info-row:nth-child(1) .info-value');
            if (pastaProgEl) pastaProgEl.textContent = folha.pastaProgramas || '';
            // Pasta PowerMill
            const pastaPMEl = document.querySelector('.project-info .info-row:nth-child(2) .info-value');
            if (pastaPMEl) pastaPMEl.textContent = folha.pastaPowerMill || '';
            // Programador
            const progEl = document.querySelector('.project-info .info-row:nth-child(3) .info-value');
            if (progEl) progEl.textContent = folha.programador || '';
            // Tempo Projeto
            const tempoEl = document.querySelector('.project-info .info-row:nth-child(4) .info-value');
            if (tempoEl) tempoEl.textContent = folha.tempoProjeto || '';
            // Sob Liq
            const sobLiqEl = document.querySelector('.project-info .info-row:nth-child(4) .info-value:last-child');
            if (sobLiqEl) sobLiqEl.textContent = folha.sobLiq || '';
            // Imagem
            const imgEl = document.querySelector('.piece-image img');
            if (imgEl) imgEl.src = folha.imagem || projeto.image || 'images/image-molde01.png';
            // Observação, Centro do Bloco, Ref em Z, etc podem ser adicionados conforme necessário
        }
        function carregarFolha() {
            const codigoProjeto = getQueryParam('codigo', 'id');
            if (!codigoProjeto) {
                showStyledAlert('Projeto não encontrado: parâmetro ausente na URL.');
                return;
            }
            const projetos = JSON.parse(localStorage.getItem('projetos')) || {};
            const projeto = projetos[codigoProjeto];
            if (projeto) preencherFolhaComProjeto(projeto);
            else showStyledAlert('Projeto não encontrado no sistema.');
        }
        document.addEventListener('DOMContentLoaded', carregarFolha);
    })();
    document.getElementById('voltarBtn').onclick = function() {
        function getQueryParam(name) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(name);
        }
        let codigo = getQueryParam('codigo') || getQueryParam('id');
        if (!codigo) {
            // Tenta buscar o último projeto acessado do localStorage
            let projetos = JSON.parse(localStorage.getItem('projetos')) || {};
            let codigos = Object.keys(projetos);
            if (codigos.length > 0) {
                codigo = codigos[codigos.length - 1]; // Pega o último
            }
        }
        if (codigo) {
            window.location.href = 'folhaprogramacao-detalhada.html?codigo=' + codigo;
        } else {
            window.location.href = 'folhaprogramacao-detalhada.html';
        }
    };
    </script>
</body>
</html>